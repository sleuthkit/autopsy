<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
    <head>
        <title>Hash Database Management</title>
        <link rel="stylesheet" href="nbdocs:/org/sleuthkit/autopsy/core/docs/ide.css" type="text/css">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>
    <body>
        <h2>Hash Database Management Window</h2>
        <p>
            The Hash Database Management window is where you can set and update your hash database information.
            Hash databases are used to identify files that are 'known'.
        </p> 
	    <ul>
        	<li>
                Known good files are those that can be safely ignored.
                This set of files frequently includes standard OS and application files.
                Ignoring such uninteresting to the investigator files, can greatly reduce image analysis time.
            </li>
        	<li>
                Known bad (also called notable) files are those that should raise awareness.
                This set will vary depending on the type of investigation, but common examples include contraband images and malware.
            </li>
	   </ul>

    	<h2>Notable / Known Bad Hashsets</h2>
    	<p>Autopsy allows for multiple known bad hash databases to be set. Autopsy supports three formats:</p>
    	<ul>
    	    <li>EnCase: An EnCase hashset file.</li>
    	    <li>MD5sum: Output from running the md5, md5sum, or md5deep program on a set of files.</li>
    	    <li>NSRL: The format of the NSRL database.</li>
    	</ul>

    	<h2>NIST NSRL</h2>
    	<p>
            Autopsy can use the <a href="http://www.nsrl.nist.gov">NIST NSRL</a> to detect 'known files'. 
            Note that the NSRL contains hashes of 'known files' that may be good or bad depending on your perspective and investigation type.
            For example, the existence of a piece of financial software may be interesting to your investigation and that software could be in the NSRL.
            Therefore, Autopsy treats files that are found in the NSRL as simply 'known' and does not specify good or bad.
            Ingest modules have the option of ignoring files that were found in the NSRL.
        </p>
    	<p>
            To use the NSRL, you must concatenate all of the NSRLFile.txt files together.
            You can use 'cat' on a Unix system or from within Cygwin to do this.
        </p>

    	<h2>Adding Hashsets</h2>
    	<p>
            Autopsy needs an index of the hashset to actualy use a hash database.
            It can create the index if you import only the hashset. 
            When you select the database from within this window, it will tell you if the index needs to be created.
            Autopsy uses the hash database management system from The Sleuth Kit. You can manually create an index using the 'hfind' command line tool or use can use Autopsy.
        </p>
    	<p>
            You can also specify only the index file and not use the full hashset - the index file is sufficient to identify known files.
            This can save space.  To do this, specify the .idx file from the Hash Database Management window.
        </p>

    	<h2>Using Hashsets</h2>
    	<p>
            There is an <a href="nbdocs:/org/sleuthkit/autopsy/ingest/docs/ingest-about.html">ingest module</a> that will hash the files and look them up in the hashsets.
            It will flag files that were in the notable hashset and those results will be shown in the Results tree of the <a href="nbdocs:/org/sleuthkit/autopsy/directorytree/docs/directorytree-about.html">Data Explorer</a>.
        </p>
    	<p>Other ingest modules are able to use the known status of a file to decide if they should ignore the file or process it.</p>
    	<p>
            You can also see the results in the <a href="nbdocs:/org/sleuthkit/autopsy/filesearch/docs/open-filesearch.html">File Search</a> window.
            There is an option to choose the 'known status'. From here, you can do a search to see all 'known bad' files. 
            From here, you can also choose to ignore all 'known' files that were found in the NSRL.
            You can also see the status of the file in a column when the file is listed.
        </p>
    	<img src="hashdb.PNG" alt="Hash Database Configuration" />
    </body>
</html>
